<% cache spree_storefront_base_cache_scope.call(product) do %>
  <% if product.storefront_description.present? %>
    <% description_text = strip_tags(product.storefront_description) %>
    <div class="pdp-accordion-item" data-controller="read-more" data-read-more-more-text-value="<%= Spree.t(:read_more) %>" data-read-more-less-text-value="Read less">
      <div class="prose product-description text-sm <%= 'product-description-truncated' if description_text.size > 250 %>" data-read-more-target="content" style="padding: 0.75rem 0; font-size: 0.875rem; color: #555; line-height: 1.6;">
        <%= raw(product.storefront_description) %>
      </div>
      <% if description_text.size > 250 %>
        <%= button_tag Spree.t(:read_more), type: 'button', data: { action: "read-more#toggle" }, class: "font-bold underline text-sm pb-4" %>
      <% end %>
    </div>
  <% end %>

  <div class="st-accordion" data-controller="accordion">
    <% short_description = product.property('short_description') %>

    <% if short_description.present? %>
      <div class="pdp-accordion-item">
        <%= link_to '#property_details', class: 'pdp-accordion-trigger', data: { action: 'accordion#toggle' } do %>
          <span>Details</span>
          <%= render 'spree/shared/icons/chevron_down' %>
        <% end %>
        <div class="pdp-accordion-content st-accordion__content" data-accordion-id="property_details">
          <%= product.description %>
        </div>
      </div>
    <% end %>

    <% shipping_policy = current_store.customer_shipping_policy %>
    <% if shipping_policy.present? %>
      <div class="pdp-accordion-item">
        <%= link_to "#property_shipping_policy", class: 'pdp-accordion-trigger', data: { action: 'accordion#toggle' } do %>
          <span><%= Spree.t(:shipping_policy) %></span>
          <%= render 'spree/shared/icons/chevron_down' %>
        <% end %>
        <div class="pdp-accordion-content st-accordion__content" data-accordion-id="property_shipping_policy">
          <%= shipping_policy %>
        </div>
      </div>
    <% end %>

    <% product_properties(product).each do |product_property| %>
      <div class="pdp-accordion-item">
        <%= link_to "#property_#{product_property.id}", class: 'pdp-accordion-trigger', data: { action: 'accordion#toggle' } do %>
          <span><%= product_property.property.presentation %></span>
          <%= render 'spree/shared/icons/chevron_down' %>
        <% end %>
        <div class="pdp-accordion-content st-accordion__content" data-accordion-id="property_<%= product_property.id %>">
          <%= simple_format(product_property.value) %>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
